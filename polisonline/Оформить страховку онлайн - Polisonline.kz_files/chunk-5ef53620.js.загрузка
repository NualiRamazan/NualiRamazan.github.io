(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5ef53620"],{"0bcd":function(t,s,e){"use strict";s["a"]=function(t){if("polisonline.local"===window.location.hostname||"polis-prod.local"===window.location.hostname)return t}},"1e9a":function(t,s,e){},"2c2c":function(t,s,e){"use strict";e("1e9a")},"394c":function(t,s,e){"use strict";e.r(s);var i=function(){var t=this,s=t.$createElement,e=t._self._c||s;return t.isOpen?e("div",{staticClass:"popup-auth-screen",class:{open:t.isOpen}},[e("div",{staticClass:"image"},["signin"==t.activeTab?e("img",{attrs:{src:t.settings.signin_image_name}}):"signup"==t.activeTab?e("img",{attrs:{src:t.settings.signup_image_name}}):"forgot"==t.activeTab?e("img",{attrs:{src:t.settings.forgot_image_name}}):"changePassword"==t.activeTab?e("img",{attrs:{src:t.settings.password_image_name}}):e("img",{attrs:{src:"/images/signup.jpg"}})]),e("div",{staticClass:"scroller"},[e("form",{staticClass:"content"},[e("img",{staticClass:"logo",attrs:{src:"/images/logo.svg"}}),e("button",{staticClass:"back-button",attrs:{type:"button"},on:{click:t.close}},[e("svg-icon",{attrs:{icon:"backArrow"}}),t._v(" "+t._s(t.$v("STR_BACK"))+" ")],1),"signin"==t.activeTab?[e("div",{staticClass:"title"},[t._v(t._s(t.$v("STR_SIGNIN")))]),e("div",{key:"signin",staticClass:"fields loading-wrap"},[t.formLoading?e("div",{staticClass:"loading"}):t._e(),e("div",{staticClass:"row"},[e("text-field",{attrs:{label:t.$v("STR_MOBILE_PHONE"),name:"tel",type:"tel",tel:""},model:{value:t.tel,callback:function(s){t.tel=s},expression:"tel"}})],1),e("div",{staticClass:"row columns margin-20"},[e("div",{staticClass:"field-column"},[e("text-field",{attrs:{label:t.$v("STR_PASSWORD"),type:"password",name:"password"},model:{value:t.password,callback:function(s){t.password=s},expression:"password"}})],1),e("div",{staticClass:"hint-column"},[e("button",{staticClass:"link-button",attrs:{type:"button"},on:{click:function(s){t.activeTab="forgot"}}},[t._v(" "+t._s(t.$v("STR_FORGOT_PASSWORD"))+" ")])])]),e("div",{staticClass:"row"},[e("button",{ref:"submitButton",staticClass:"button",attrs:{type:"button"},on:{click:t.submitSignin}},[t._v(" "+t._s(t.$v("STR_SIGNIN"))+" ")])])]),e("div",{staticClass:"line"}),e("div",{staticClass:"subtitle"},[t._v(" "+t._s(t.$v("STR_SIGNUP_DESC_TITLE"))+" ")]),e("div",{staticClass:"description"},[e("button",{staticClass:"link-button",attrs:{type:"button"},on:{click:function(s){t.activeTab="signup"}}},[t._v(" "+t._s(t.$v("STR_SIGNUP_DESC_BUTTON"))+" ")]),t._v(" "+t._s(t.$v("STR_SIGNUP_DESC"))+" ")])]:"signup"==t.activeTab?[e("div",{staticClass:"title"},[t._v(t._s(t.$v("STR_SIGNUP")))]),e("div",{key:"signup",staticClass:"fields loading-wrap"},[t.formLoading?e("div",{staticClass:"loading"}):t._e(),e("div",{staticClass:"row wide switch"},[e("button",{staticClass:"tab",class:{current:"person"===t.clientKind},attrs:{type:"button"},on:{click:function(s){t.clientKind="person"}}},[t._v(" "+t._s(t.$v("STR_INDIVIDUAL"))+" ")]),e("button",{staticClass:"tab",class:{current:"ie"===t.clientKind},attrs:{type:"button"},on:{click:function(s){t.clientKind="ie"}}},[t._v(" "+t._s(t.$v("STR_IE"))+" ")]),e("button",{staticClass:"tab",class:{current:"entity"===t.clientKind},attrs:{type:"button"},on:{click:function(s){t.clientKind="entity"}}},[t._v(" "+t._s(t.$v("STR_ENTITY"))+" ")])]),e("div",{staticClass:"row"},[e("text-field",{attrs:{label:t.found?t.displayName:"entity"===t.clientKind?t.$v("STR_BIN"):t.$v("STR_IIN"),numbers:"",loading:t.clientLoading>0,maxLength:12,error:t.errors.bin},model:{value:t.bin,callback:function(s){t.bin=s},expression:"bin"}})],1),e("div",{staticClass:"row"},[e("text-field",{attrs:{label:t.$v("STR_MOBILE_PHONE"),type:"tel",error:t.errors.tel,tel:""},model:{value:t.tel,callback:function(s){t.tel=s},expression:"tel"}})],1),e("div",{staticClass:"row"},[e("text-field",{attrs:{label:t.$v("STR_PASSWORD"),type:"password",error:t.errors.password},model:{value:t.password,callback:function(s){t.password=s},expression:"password"}})],1),e("div",{staticClass:"row margin-20"},[e("text-field",{attrs:{label:t.$v("STR_REPEAT_PASSWORD"),type:"password",error:t.errors.passwordRepeat},model:{value:t.passwordRepeat,callback:function(s){t.passwordRepeat=s},expression:"passwordRepeat"}})],1),e("div",{staticClass:"row"},[e("button",{ref:"submitButton",staticClass:"button",attrs:{type:"button"},on:{click:t.submitSignup}},[t._v(" "+t._s(t.$v("STR_SIGNUP"))+" ")])])]),e("div",{staticClass:"line"}),e("div",{staticClass:"subtitle"},[t._v(" "+t._s(t.$v("STR_SIGNIN_DESC_TITLE"))+" ")]),e("div",{staticClass:"description"},[e("button",{staticClass:"link-button",attrs:{type:"button"},on:{click:function(s){t.activeTab="signin"}}},[t._v(" "+t._s(t.$v("STR_SIGNIN_DESC_BUTTON"))+" ")]),t._v(" "+t._s(t.$v("STR_SIGNIN_DESC"))+" ")])]:t._e(),"forgot"==t.activeTab?[e("div",{staticClass:"title"},[t._v(t._s(t.$v("STR_RESTORE_PASSWORD")))]),e("div",{key:"forgot",staticClass:"fields loading-wrap"},[e("div",{staticClass:"row margin-20"},[e("text-field",{attrs:{label:t.$v("STR_MOBILE_PHONE"),type:"tel",error:t.errors.tel,tel:""},model:{value:t.tel,callback:function(s){t.tel=s},expression:"tel"}})],1),e("div",{staticClass:"row"},[e("button",{ref:"submitButton",staticClass:"button",attrs:{type:"button"},on:{click:t.submitForgot}},[t._v(" "+t._s(t.$v("STR_RESTORE"))+" ")])])]),e("div",{staticClass:"line"}),e("div",{staticClass:"subtitle"},[t._v(" "+t._s(t.$v("STR_SIGNIN_DESC2_TITLE"))+" ")]),e("div",{staticClass:"description"},[e("button",{staticClass:"link-button",attrs:{type:"button"},on:{click:function(s){t.activeTab="signin"}}},[t._v(" "+t._s(t.$v("STR_SIGNIN_DESC_BUTTON"))+" ")]),t._v(" "+t._s(t.$v("STR_SIGNIN_DESC"))+" ")])]:t._e(),"changePassword"==t.activeTab?[e("div",{staticClass:"title"},[t._v(t._s(t.$v("STR_CHANGE_PASSWORD")))]),e("div",{key:"changePassword",staticClass:"fields loading-wrap"},[e("div",{staticClass:"row"},[e("text-field",{attrs:{label:t.$v("STR_PASSWORD"),type:"password",error:t.errors.password},model:{value:t.password,callback:function(s){t.password=s},expression:"password"}})],1),e("div",{staticClass:"row margin-20"},[e("text-field",{attrs:{label:t.$v("STR_REPEAT_PASSWORD"),type:"password",error:t.errors.passwordRepeat},model:{value:t.passwordRepeat,callback:function(s){t.passwordRepeat=s},expression:"passwordRepeat"}})],1),e("div",{staticClass:"row"},[e("button",{ref:"submitButton",staticClass:"button",attrs:{type:"button"},on:{click:t.submitChangePassword}},[t._v(" "+t._s(t.$v("STR_SAVE"))+" ")])])]),e("div",{staticClass:"line"}),e("div",{staticClass:"subtitle"},[t._v(" "+t._s(t.$v("STR_SIGNIN_DESC2_TITLE"))+" ")]),e("div",{staticClass:"description"},[e("button",{staticClass:"link-button",attrs:{type:"button"},on:{click:function(s){t.activeTab="signin"}}},[t._v(" "+t._s(t.$v("STR_SIGNIN_DESC_BUTTON"))+" ")]),t._v(" "+t._s(t.$v("STR_SIGNIN_DESC"))+" ")])]:t._e()],2)])]):t._e()},a=[],n=e("a109"),o=e("0bcd"),r={props:{settings:Object,redirect:{type:String,required:!1,default:null}},data(){return{isOpen:!1,activeTab:"signin",clientKind:"person",bin:"",tel:"",password:"",passwordRepeat:"",found:null,displayName:"",clientLoading:0,formLoading:0,errors:this.getEmptyErrors()}},watch:{clientKind(){this.updateName()},bin(){this.updateName()},isOpen(t){t?document.body.classList.add("no-scroll"):setTimeout(()=>{document.body.classList.remove("no-scroll")},300)}},methods:{open(t){this.activeTab=t&&"signup"===t?"signup":"signin",this.isOpen=!0},close(){this.isOpen=!1},updateName(){this.found=null,this.displayName="";const t=this.bin.replace(/[^0-9]/gi,"");if(12!=t.length)return;const s="entity"===this.clientKind?"/Person/getTitleByBIN/":"/Person/getNameByIIN/";this.clientLoading++,this.$axios.get(s+t).then(s=>{this.clientLoading--,0===s.code&&s.data&&s.data.bin==t?(this.found=!0,this.displayName=s.data.name):0!==s.code&&s.data&&s.data.bin==t&&(this.found=!1,this.displayName="")}).catch(t=>{throw this.found=null,this.clientLoading--,t})},submitSignin(){let t=!1;this.errors=this.getEmptyErrors();const s=this.tel.replace(/[^0-9]/gi,"");11!=s.length&&(this.errors.tel=!0,t=!0);const e=this.password;e.length<1&&(t||this.$root.openDialog("Заполните, пожалуйстиа, пароль"),this.errors.password=!0,t=!0),t||(this.formLoading++,this.$axios.post("/User/signin",{tel:s,password:e}).then(t=>{if(0===t.code&&t.data.token){const s=new Date(Date.now()+864e5).toUTCString();document.cookie="authToken="+encodeURIComponent(t.data.token)+"; path=/; expires="+s,Object(o["a"])({event:"login",userId:t.data.id}),this.redirect?window.location=this.redirect:window.location="/profile/"}else this.formLoading--,this.$root.openDialog(Object(n["a"])(t),{html:!0,textClass:["text-align-center"]})}).catch(t=>{this.formLoading--,console.error(t),this.$root.openDialog(this.$v("STR_SYSTEM_ERROR"),{html:!0,textClass:["text-align-center"]})}))},submitSignup(){let t=!1;this.errors=this.getEmptyErrors();const s=this.bin.replace(/[^0-9]/gi,"");12==s.length&&this.found||(this.errors.bin=!0,t=!0);const e=this.tel.replace(/[^0-9]/gi,"");11!=e.length&&(this.errors.tel=!0,t=!0);const i=this.password;i.length<8&&(t||(i.length<1?this.$root.openDialog("Заполните, пожалуйстиа, пароль"):this.$root.openDialog("Пароль не должен быть короче 8 знаков")),this.errors.password=!0,t=!0);const a=this.passwordRepeat;a!=i&&(t||this.$root.openDialog("Пароли не совпадают"),this.errors.passwordRepeat=!0,t=!0),t||(this.formLoading++,this.$axios.post("/User/signupCheck",{clientKind:this.clientKind,bin:s,tel:e}).then(t=>{this.formLoading--,0===t.code?this.$root.sendOTP(this.tel,this.$v("STR_OTP_WINDOW_DESCRIPTION"),null,(t,e,a)=>{this.formLoading++,this.$axios.post("/User/signup",{clientKind:this.clientKind,bin:s,tel:t,password:i,otpToken:e,otpCode:a}).then(t=>{this.formLoading--,0===t.code?(Object(o["a"])({event:"registration",userType:"person"==this.clientKind?"Personal":"Business",authenticationMethod:"phone",userId:t.data.id}),this.bin="",this.tel="",this.password="",this.passwordRepeat="",this.$root.openDialog(this.$v("STR_SIGNUP_SUCCESS"))):this.$root.openDialog(Object(n["a"])(t),{html:!0,textClass:["text-align-center"]})}).catch(t=>{console.error(t),this.$root.openDialog(this.$v("STR_SYSTEM_ERROR"),{html:!0,textClass:["text-align-center"]})})}):this.$root.openDialog(Object(n["a"])(t),{html:!0,textClass:["text-align-center"]})}).catch(t=>{console.error(t),this.$root.openDialog(this.$v("STR_SYSTEM_ERROR"),{html:!0,textClass:["text-align-center"]})}))},submitForgot(){let t=!1;this.errors=this.getEmptyErrors();const s=this.tel.replace(/[^0-9]/gi,"");11!=s.length&&(this.errors.tel=!0,t=!0),t||(this.formLoading++,this.$axios.get("/User/isTelRegistered/"+s).then(t=>{this.formLoading--,0===t.code?this.activeTab="changePassword":this.$root.openDialog(Object(n["a"])(t),{html:!0,textClass:["text-align-center"]})}).catch(t=>{console.error(t),this.$root.openDialog(this.$v("STR_SYSTEM_ERROR"),{html:!0,textClass:["text-align-center"]})}))},submitChangePassword(){let t=!1;this.errors=this.getEmptyErrors();const s=this.tel.replace(/[^0-9]/gi,""),e=this.password;e.length<8&&(t||(e.length<1?this.$root.openDialog("Заполните, пожалуйстиа, пароль"):this.$root.openDialog("Пароль не должен быть короче 8 знаков")),this.errors.password=!0,t=!0);const i=this.passwordRepeat;i!=e&&(t||this.$root.openDialog("Пароли не совпадают"),this.errors.passwordRepeat=!0,t=!0),t||this.$root.sendOTP(s,this.$v("STR_OTP_WINDOW_SIGNUP_DESCRIPTION"),null,(t,s,i)=>{this.formLoading++,this.$axios.post("/User/changePassword",{tel:t,password:e,otpToken:s,otpCode:i}).then(t=>{this.formLoading--,0===t.code?(this.activeTab="signin",this.tel="",this.password="",this.passwordRepeat="",this.$root.openDialog(this.$v("STR_PASSWORD_CHANGED"))):this.$root.openDialog(Object(n["a"])(t),{html:!0,textClass:["text-align-center"]})}).catch(t=>{console.error(t),this.$root.openDialog(this.$v("STR_SYSTEM_ERROR"),{html:!0,textClass:["text-align-center"]})})})},getEmptyErrors(){return{bin:!1,tel:!1,password:!1,passwordRepeat:!1}}},mounted(){window.location.hash&&"#login"==window.location.hash?(this.isOpen=!0,this.activeTab="signin"):window.location.hash&&"#register"==window.location.hash&&(this.isOpen=!0,this.activeTab="signup")}},l=r,c=(e("2c2c"),e("2877")),p=Object(c["a"])(l,i,a,!1,null,"1e777850",null);s["default"]=p.exports},a109:function(t,s,e){"use strict";var i=e("e19f"),a=e("a6fe");s["a"]=function(t){if(0===t.code)return null;let s=null;return t.msgId&&(s=Object(a["a"])(t.msgId),s&&s.length>0&&t.msgData&&(s=Object(i["vsprintf"])(s,t.msgData))),!s&&t.rawMsg&&(s=t.rawMsg),s||(s=Object(a["a"])("STR_SYSTEM_ERROR")),s||(s="Произошла ошибка"),s}},e19f:function(t,s,e){var i;!function(){"use strict";var a={not_string:/[^s]/,not_bool:/[^t]/,not_type:/[^T]/,not_primitive:/[^v]/,number:/[diefg]/,numeric_arg:/[bcdiefguxX]/,json:/[j]/,not_json:/[^j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijostTuvxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[+-]/};function n(t){return r(c(t),arguments)}function o(t,s){return n.apply(null,[t].concat(s||[]))}function r(t,s){var e,i,o,r,l,c,p,d,u,h=1,g=t.length,_="";for(i=0;i<g;i++)if("string"===typeof t[i])_+=t[i];else if("object"===typeof t[i]){if(r=t[i],r.keys)for(e=s[h],o=0;o<r.keys.length;o++){if(void 0==e)throw new Error(n('[sprintf] Cannot access property "%s" of undefined value "%s"',r.keys[o],r.keys[o-1]));e=e[r.keys[o]]}else e=r.param_no?s[r.param_no]:s[h++];if(a.not_type.test(r.type)&&a.not_primitive.test(r.type)&&e instanceof Function&&(e=e()),a.numeric_arg.test(r.type)&&"number"!==typeof e&&isNaN(e))throw new TypeError(n("[sprintf] expecting number but found %T",e));switch(a.number.test(r.type)&&(d=e>=0),r.type){case"b":e=parseInt(e,10).toString(2);break;case"c":e=String.fromCharCode(parseInt(e,10));break;case"d":case"i":e=parseInt(e,10);break;case"j":e=JSON.stringify(e,null,r.width?parseInt(r.width):0);break;case"e":e=r.precision?parseFloat(e).toExponential(r.precision):parseFloat(e).toExponential();break;case"f":e=r.precision?parseFloat(e).toFixed(r.precision):parseFloat(e);break;case"g":e=r.precision?String(Number(e.toPrecision(r.precision))):parseFloat(e);break;case"o":e=(parseInt(e,10)>>>0).toString(8);break;case"s":e=String(e),e=r.precision?e.substring(0,r.precision):e;break;case"t":e=String(!!e),e=r.precision?e.substring(0,r.precision):e;break;case"T":e=Object.prototype.toString.call(e).slice(8,-1).toLowerCase(),e=r.precision?e.substring(0,r.precision):e;break;case"u":e=parseInt(e,10)>>>0;break;case"v":e=e.valueOf(),e=r.precision?e.substring(0,r.precision):e;break;case"x":e=(parseInt(e,10)>>>0).toString(16);break;case"X":e=(parseInt(e,10)>>>0).toString(16).toUpperCase();break}a.json.test(r.type)?_+=e:(!a.number.test(r.type)||d&&!r.sign?u="":(u=d?"+":"-",e=e.toString().replace(a.sign,"")),c=r.pad_char?"0"===r.pad_char?"0":r.pad_char.charAt(1):" ",p=r.width-(u+e).length,l=r.width&&p>0?c.repeat(p):"",_+=r.align?u+e+l:"0"===c?u+l+e:l+u+e)}return _}var l=Object.create(null);function c(t){if(l[t])return l[t];var s,e=t,i=[],n=0;while(e){if(null!==(s=a.text.exec(e)))i.push(s[0]);else if(null!==(s=a.modulo.exec(e)))i.push("%");else{if(null===(s=a.placeholder.exec(e)))throw new SyntaxError("[sprintf] unexpected placeholder");if(s[2]){n|=1;var o=[],r=s[2],c=[];if(null===(c=a.key.exec(r)))throw new SyntaxError("[sprintf] failed to parse named argument key");o.push(c[1]);while(""!==(r=r.substring(c[0].length)))if(null!==(c=a.key_access.exec(r)))o.push(c[1]);else{if(null===(c=a.index_access.exec(r)))throw new SyntaxError("[sprintf] failed to parse named argument key");o.push(c[1])}s[2]=o}else n|=2;if(3===n)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");i.push({placeholder:s[0],param_no:s[1],keys:s[2],sign:s[3],pad_char:s[4],align:s[5],width:s[6],precision:s[7],type:s[8]})}e=e.substring(s[0].length)}return l[t]=i}s["sprintf"]=n,s["vsprintf"]=o,"undefined"!==typeof window&&(window["sprintf"]=n,window["vsprintf"]=o,i=function(){return{sprintf:n,vsprintf:o}}.call(s,e,s,t),void 0===i||(t.exports=i))}()}}]);